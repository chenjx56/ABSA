# Deep Weighted MaxSAT for Aspect-based Opinion Extraction

面向基于属性的情感抽取的深度加权MaxSAT

## 摘要

大多数深度学习模型缺乏编码显式领域知识的能力，无法建模不同类型变量之间的复杂因果关系。另一方面，逻辑规则提供了一个简单表示来表示因果关系，以指导训练过程。逻辑程序可以被转换成一个可满足性问题，它的目标是通过最大化可满足子句的数量来找到逻辑变量的真值赋值。

采用MaxSAT语义去建模逻辑推理程序，很自然地融合了MaxSAT的加权版本，在一个联合框架中连接了深度神经网络和一个图模型。这个联合模型把深度学习的输出喂给加权MaxSAT层去修正错误的预测，并且通过端到端的梯度下降法进行训练。我们提出的模型利用了高层次的特征学习、常识推理、结构学习的益处，在基于属性的情感抽取任务上获得了可观的性能。



## 引言

以前的一些做法：

- 虽然把规则作为一种约束，引入到深度神经网络中，但这种约束不能回传给特征学习程序。
- 通过最小化他们之间的差异，来合并深度学习和逻辑规则。然而，他们的方法只是间接指导训练中的深度学习，而没有能力根据推理中的逻辑规则修正预测。

我们提出**DeepWMaxSAT**：

- 通过加权MaxSAT层**融合逻辑知识**到深度学习架构中
- 组成
  - DNN层（把输入embedding转换成一个高层次的特征表示）
  - 加权MaxSAT层（把DNN的输出作为在逻辑变量上的初始概率评估，产生与所选逻辑规则的头原子对应的输出逻辑变量）
  - CRF（生成结构输出，即生成一个合理的标记序列）
  - 为了充分利用DNN与逻辑程序的优点，采用了残差连接，用开学习的权重合并了两个模块的输出，交给CRF来进行标记序列
- 所有逻辑规则的合取范式中得到的属性词与意见词之前的全部关系都被编码到了MaxSAT中
  - 在CNF公式中，每个析取子句都有一个可学习的权重，以表明其置信度。
  - 加权MaxSAT层可以根据预先设置的规则纠正DNN预测
- 

